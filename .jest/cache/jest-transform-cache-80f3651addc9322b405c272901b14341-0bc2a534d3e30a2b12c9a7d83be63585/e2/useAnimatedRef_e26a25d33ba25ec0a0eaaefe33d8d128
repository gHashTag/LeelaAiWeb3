24c94461d1f448e1a25677b3ff08bdac
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.useAnimatedRef = useAnimatedRef;
var _react = require("react");
var _useSharedValue = require("./useSharedValue");
var _fabricUtils = require("../fabricUtils");
var _shareables = require("../shareables");
var _reactNative = require("react-native");
function getComponentOrScrollableRef(component) {
  if (global._IS_FABRIC && component.getNativeScrollRef) {
    return component.getNativeScrollRef();
  } else if (!global._IS_FABRIC && component.getScrollableNode) {
    return component.getScrollableNode();
  }
  return component;
}
var getTagValueFunction = global._IS_FABRIC ? _fabricUtils.getShadowNodeWrapperFromRef : _reactNative.findNodeHandle;
function useAnimatedRef() {
  var tag = (0, _useSharedValue.useSharedValue)(-1);
  var ref = (0, _react.useRef)();
  if (!ref.current) {
    var fun = function fun(component) {
      if (component) {
        tag.value = getTagValueFunction(getComponentOrScrollableRef(component));
        fun.current = component;
      }
      return tag.value;
    };
    fun.current = null;
    var remoteRef = (0, _shareables.makeShareableCloneRecursive)({
      __init: function __init() {
        'worklet';

        return function () {
          return tag.value;
        };
      }
    });
    (0, _shareables.registerShareableMapping)(fun, remoteRef);
    ref.current = fun;
  }
  return ref.current;
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfcmVhY3QiLCJyZXF1aXJlIiwiX3VzZVNoYXJlZFZhbHVlIiwiX2ZhYnJpY1V0aWxzIiwiX3NoYXJlYWJsZXMiLCJfcmVhY3ROYXRpdmUiLCJnZXRDb21wb25lbnRPclNjcm9sbGFibGVSZWYiLCJjb21wb25lbnQiLCJnbG9iYWwiLCJfSVNfRkFCUklDIiwiZ2V0TmF0aXZlU2Nyb2xsUmVmIiwiZ2V0U2Nyb2xsYWJsZU5vZGUiLCJnZXRUYWdWYWx1ZUZ1bmN0aW9uIiwiZ2V0U2hhZG93Tm9kZVdyYXBwZXJGcm9tUmVmIiwiZmluZE5vZGVIYW5kbGUiLCJ1c2VBbmltYXRlZFJlZiIsInRhZyIsInVzZVNoYXJlZFZhbHVlIiwicmVmIiwidXNlUmVmIiwiY3VycmVudCIsImZ1biIsInZhbHVlIiwicmVtb3RlUmVmIiwibWFrZVNoYXJlYWJsZUNsb25lUmVjdXJzaXZlIiwiX19pbml0IiwicmVnaXN0ZXJTaGFyZWFibGVNYXBwaW5nIl0sInNvdXJjZXMiOlsidXNlQW5pbWF0ZWRSZWYudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VSZWYgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgeyB1c2VTaGFyZWRWYWx1ZSB9IGZyb20gJy4vdXNlU2hhcmVkVmFsdWUnO1xuaW1wb3J0IHR5cGUgeyBBbmltYXRlZFJlZiwgUmVmT2JqZWN0RnVuY3Rpb24gfSBmcm9tICcuL2NvbW1vblR5cGVzJztcbmltcG9ydCB0eXBlIHsgU2hhZG93Tm9kZVdyYXBwZXIgfSBmcm9tICcuLi9jb21tb25UeXBlcyc7XG5pbXBvcnQgeyBnZXRTaGFkb3dOb2RlV3JhcHBlckZyb21SZWYgfSBmcm9tICcuLi9mYWJyaWNVdGlscyc7XG5pbXBvcnQge1xuICBtYWtlU2hhcmVhYmxlQ2xvbmVSZWN1cnNpdmUsXG4gIHJlZ2lzdGVyU2hhcmVhYmxlTWFwcGluZyxcbn0gZnJvbSAnLi4vc2hhcmVhYmxlcyc7XG5pbXBvcnQgeyBmaW5kTm9kZUhhbmRsZSB9IGZyb20gJ3JlYWN0LW5hdGl2ZSc7XG5cbmludGVyZmFjZSBDb21wb25lbnRSZWYgZXh0ZW5kcyBDb21wb25lbnQge1xuICBnZXROYXRpdmVTY3JvbGxSZWY/OiAoKSA9PiBDb21wb25lbnRSZWY7XG4gIGdldFNjcm9sbGFibGVOb2RlPzogKCkgPT4gQ29tcG9uZW50UmVmO1xufVxuXG5mdW5jdGlvbiBnZXRDb21wb25lbnRPclNjcm9sbGFibGVSZWYoY29tcG9uZW50OiBDb21wb25lbnRSZWYpOiBDb21wb25lbnRSZWYge1xuICBpZiAoZ2xvYmFsLl9JU19GQUJSSUMgJiYgY29tcG9uZW50LmdldE5hdGl2ZVNjcm9sbFJlZikge1xuICAgIHJldHVybiBjb21wb25lbnQuZ2V0TmF0aXZlU2Nyb2xsUmVmKCk7XG4gIH0gZWxzZSBpZiAoIWdsb2JhbC5fSVNfRkFCUklDICYmIGNvbXBvbmVudC5nZXRTY3JvbGxhYmxlTm9kZSkge1xuICAgIHJldHVybiBjb21wb25lbnQuZ2V0U2Nyb2xsYWJsZU5vZGUoKTtcbiAgfVxuICByZXR1cm4gY29tcG9uZW50O1xufVxuXG5jb25zdCBnZXRUYWdWYWx1ZUZ1bmN0aW9uID0gZ2xvYmFsLl9JU19GQUJSSUNcbiAgPyBnZXRTaGFkb3dOb2RlV3JhcHBlckZyb21SZWZcbiAgOiBmaW5kTm9kZUhhbmRsZTtcblxuZXhwb3J0IGZ1bmN0aW9uIHVzZUFuaW1hdGVkUmVmPFQgZXh0ZW5kcyBDb21wb25lbnRSZWY+KCk6IEFuaW1hdGVkUmVmPFQ+IHtcbiAgY29uc3QgdGFnID0gdXNlU2hhcmVkVmFsdWU8bnVtYmVyIHwgU2hhZG93Tm9kZVdyYXBwZXIgfCBudWxsPigtMSk7XG4gIGNvbnN0IHJlZiA9IHVzZVJlZjxSZWZPYmplY3RGdW5jdGlvbjxUPj4oKTtcblxuICBpZiAoIXJlZi5jdXJyZW50KSB7XG4gICAgY29uc3QgZnVuOiBSZWZPYmplY3RGdW5jdGlvbjxUPiA9IDxSZWZPYmplY3RGdW5jdGlvbjxUPj4oKGNvbXBvbmVudCkgPT4ge1xuICAgICAgLy8gZW50ZXJzIHdoZW4gcmVmIGlzIHNldCBieSBhdHRhY2hpbmcgdG8gYSBjb21wb25lbnRcbiAgICAgIGlmIChjb21wb25lbnQpIHtcbiAgICAgICAgdGFnLnZhbHVlID0gZ2V0VGFnVmFsdWVGdW5jdGlvbihnZXRDb21wb25lbnRPclNjcm9sbGFibGVSZWYoY29tcG9uZW50KSk7XG4gICAgICAgIGZ1bi5jdXJyZW50ID0gY29tcG9uZW50O1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRhZy52YWx1ZTtcbiAgICB9KTtcblxuICAgIGZ1bi5jdXJyZW50ID0gbnVsbDtcblxuICAgIGNvbnN0IHJlbW90ZVJlZiA9IG1ha2VTaGFyZWFibGVDbG9uZVJlY3Vyc2l2ZSh7XG4gICAgICBfX2luaXQ6ICgpID0+IHtcbiAgICAgICAgJ3dvcmtsZXQnO1xuICAgICAgICByZXR1cm4gKCkgPT4gdGFnLnZhbHVlO1xuICAgICAgfSxcbiAgICB9KTtcbiAgICByZWdpc3RlclNoYXJlYWJsZU1hcHBpbmcoZnVuLCByZW1vdGVSZWYpO1xuICAgIHJlZi5jdXJyZW50ID0gZnVuO1xuICB9XG5cbiAgcmV0dXJuIHJlZi5jdXJyZW50O1xufVxuIl0sIm1hcHBpbmdzIjoiOzs7O0FBQ0EsSUFBQUEsTUFBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsZUFBQSxHQUFBRCxPQUFBO0FBR0EsSUFBQUUsWUFBQSxHQUFBRixPQUFBO0FBQ0EsSUFBQUcsV0FBQSxHQUFBSCxPQUFBO0FBSUEsSUFBQUksWUFBQSxHQUFBSixPQUFBO0FBT0EsU0FBU0ssMkJBQTJCQSxDQUFDQyxTQUF1QixFQUFnQjtFQUMxRSxJQUFJQyxNQUFNLENBQUNDLFVBQVUsSUFBSUYsU0FBUyxDQUFDRyxrQkFBa0IsRUFBRTtJQUNyRCxPQUFPSCxTQUFTLENBQUNHLGtCQUFrQixFQUFFO0VBQ3ZDLENBQUMsTUFBTSxJQUFJLENBQUNGLE1BQU0sQ0FBQ0MsVUFBVSxJQUFJRixTQUFTLENBQUNJLGlCQUFpQixFQUFFO0lBQzVELE9BQU9KLFNBQVMsQ0FBQ0ksaUJBQWlCLEVBQUU7RUFDdEM7RUFDQSxPQUFPSixTQUFTO0FBQ2xCO0FBRUEsSUFBTUssbUJBQW1CLEdBQUdKLE1BQU0sQ0FBQ0MsVUFBVSxHQUN6Q0ksd0NBQTJCLEdBQzNCQywyQkFBYztBQUVYLFNBQVNDLGNBQWNBLENBQUEsRUFBMkM7RUFDdkUsSUFBTUMsR0FBRyxHQUFHLElBQUFDLDhCQUFjLEVBQW9DLENBQUMsQ0FBQyxDQUFDO0VBQ2pFLElBQU1DLEdBQUcsR0FBRyxJQUFBQyxhQUFNLEdBQXdCO0VBRTFDLElBQUksQ0FBQ0QsR0FBRyxDQUFDRSxPQUFPLEVBQUU7SUFDaEIsSUFBTUMsR0FBeUIsR0FBMkIsU0FBcERBLEdBQXlCQSxDQUEyQmQsU0FBUyxFQUFLO01BRXRFLElBQUlBLFNBQVMsRUFBRTtRQUNiUyxHQUFHLENBQUNNLEtBQUssR0FBR1YsbUJBQW1CLENBQUNOLDJCQUEyQixDQUFDQyxTQUFTLENBQUMsQ0FBQztRQUN2RWMsR0FBRyxDQUFDRCxPQUFPLEdBQUdiLFNBQVM7TUFDekI7TUFDQSxPQUFPUyxHQUFHLENBQUNNLEtBQUs7SUFDbEIsQ0FBRTtJQUVGRCxHQUFHLENBQUNELE9BQU8sR0FBRyxJQUFJO0lBRWxCLElBQU1HLFNBQVMsR0FBRyxJQUFBQyx1Q0FBMkIsRUFBQztNQUM1Q0MsTUFBTSxFQUFFLFNBQUFBLE9BQUEsRUFBTTtRQUNaLFNBQVM7O1FBQ1QsT0FBTztVQUFBLE9BQU1ULEdBQUcsQ0FBQ00sS0FBSztRQUFBO01BQ3hCO0lBQ0YsQ0FBQyxDQUFDO0lBQ0YsSUFBQUksb0NBQXdCLEVBQUNMLEdBQUcsRUFBRUUsU0FBUyxDQUFDO0lBQ3hDTCxHQUFHLENBQUNFLE9BQU8sR0FBR0MsR0FBRztFQUNuQjtFQUVBLE9BQU9ILEdBQUcsQ0FBQ0UsT0FBTztBQUNwQiJ9