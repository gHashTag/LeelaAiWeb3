{"version":3,"names":["_Hooks","require","EventType","UNDETERMINED","FAILED","BEGAN","CANCELLED","ACTIVE","END","exports","useAnimatedGestureHandler","handlers","dependencies","_useHandler","useHandler","context","doDependenciesDiffer","useWeb","handler","e","event","nativeEvent","state","onStart","onActive","oldState","onEnd","onFail","onCancel","onFinish","useEvent"],"sources":["useAnimatedGestureHandler.ts"],"sourcesContent":["import type { Context, WorkletFunction, NativeEvent } from '../commonTypes';\nimport type { DependencyList } from './commonTypes';\nimport { useEvent, useHandler } from './Hooks';\n\ninterface Handler<T, TContext extends Context> extends WorkletFunction {\n  (event: T, context: TContext, isCanceledOrFailed?: boolean): void;\n}\n\nexport interface GestureHandlers<T, TContext extends Context> {\n  [key: string]: Handler<T, TContext> | undefined;\n  onStart?: Handler<T, TContext>;\n  onActive?: Handler<T, TContext>;\n  onEnd?: Handler<T, TContext>;\n  onFail?: Handler<T, TContext>;\n  onCancel?: Handler<T, TContext>;\n  onFinish?: Handler<T, TContext>;\n}\n\nexport const EventType = {\n  UNDETERMINED: 0,\n  FAILED: 1,\n  BEGAN: 2,\n  CANCELLED: 3,\n  ACTIVE: 4,\n  END: 5,\n};\n\nexport interface GestureHandlerNativeEvent {\n  handlerTag: number;\n  numberOfPointers: number;\n  state: (typeof EventType)[keyof typeof EventType];\n}\n\nexport interface GestureHandlerEvent<T> extends NativeEvent<T> {\n  nativeEvent: T;\n}\n\ntype InferArgument<T> = T extends GestureHandlerEvent<infer E>\n  ? E extends GestureHandlerNativeEvent\n    ? E\n    : never\n  : never;\n\nexport function useAnimatedGestureHandler<\n  T extends GestureHandlerEvent<any>,\n  TContext extends Context = Context,\n  Payload = InferArgument<T>\n>(\n  handlers: GestureHandlers<Payload, TContext>,\n  dependencies?: DependencyList\n): (e: T) => void {\n  const { context, doDependenciesDiffer, useWeb } = useHandler<\n    Payload,\n    TContext\n  >(handlers, dependencies);\n\n  const handler = (e: T) => {\n    'worklet';\n    const event = useWeb ? e.nativeEvent : e;\n\n    if (event.state === EventType.BEGAN && handlers.onStart) {\n      handlers.onStart(event, context);\n    }\n    if (event.state === EventType.ACTIVE && handlers.onActive) {\n      handlers.onActive(event, context);\n    }\n    if (\n      event.oldState === EventType.ACTIVE &&\n      event.state === EventType.END &&\n      handlers.onEnd\n    ) {\n      handlers.onEnd(event, context);\n    }\n    if (\n      event.oldState === EventType.BEGAN &&\n      event.state === EventType.FAILED &&\n      handlers.onFail\n    ) {\n      handlers.onFail(event, context);\n    }\n    if (\n      event.oldState === EventType.ACTIVE &&\n      event.state === EventType.CANCELLED &&\n      handlers.onCancel\n    ) {\n      handlers.onCancel(event, context);\n    }\n    if (\n      (event.oldState === EventType.BEGAN ||\n        event.oldState === EventType.ACTIVE) &&\n      event.state !== EventType.BEGAN &&\n      event.state !== EventType.ACTIVE &&\n      handlers.onFinish\n    ) {\n      handlers.onFinish(\n        event,\n        context,\n        event.state === EventType.CANCELLED || event.state === EventType.FAILED\n      );\n    }\n  };\n\n  if (useWeb) {\n    return handler;\n  }\n\n  return useEvent<T>(\n    handler,\n    ['onGestureHandlerStateChange', 'onGestureHandlerEvent'],\n    doDependenciesDiffer\n  ) as unknown as (e: T) => void; // this is not correct but we want to make GH think it receives a function\n}\n"],"mappings":";;;;;AAEA,IAAAA,MAAA,GAAAC,OAAA;AAgBO,IAAMC,SAAS,GAAG;EACvBC,YAAY,EAAE,CAAC;EACfC,MAAM,EAAE,CAAC;EACTC,KAAK,EAAE,CAAC;EACRC,SAAS,EAAE,CAAC;EACZC,MAAM,EAAE,CAAC;EACTC,GAAG,EAAE;AACP,CAAC;AAAAC,OAAA,CAAAP,SAAA,GAAAA,SAAA;AAkBM,SAASQ,yBAAyBA,CAKvCC,QAA4C,EAC5CC,YAA6B,EACb;EAChB,IAAAC,WAAA,GAAkD,IAAAC,iBAAU,EAG1DH,QAAQ,EAAEC,YAAY,CAAC;IAHjBG,OAAO,GAAAF,WAAA,CAAPE,OAAO;IAAEC,oBAAoB,GAAAH,WAAA,CAApBG,oBAAoB;IAAEC,MAAA,GAAAJ,WAAA,CAAAI,MAAA;EAKvC,IAAMC,OAAO,GAAI,SAAXA,OAAOA,CAAIC,CAAI,EAAK;IACxB,SAAS;;IACT,IAAMC,KAAK,GAAGH,MAAM,GAAGE,CAAC,CAACE,WAAW,GAAGF,CAAC;IAExC,IAAIC,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACG,KAAK,IAAIM,QAAQ,CAACY,OAAO,EAAE;MACvDZ,QAAQ,CAACY,OAAO,CAACH,KAAK,EAAEL,OAAO,CAAC;IAClC;IACA,IAAIK,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACK,MAAM,IAAII,QAAQ,CAACa,QAAQ,EAAE;MACzDb,QAAQ,CAACa,QAAQ,CAACJ,KAAK,EAAEL,OAAO,CAAC;IACnC;IACA,IACEK,KAAK,CAACK,QAAQ,KAAKvB,SAAS,CAACK,MAAM,IACnCa,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACM,GAAG,IAC7BG,QAAQ,CAACe,KAAK,EACd;MACAf,QAAQ,CAACe,KAAK,CAACN,KAAK,EAAEL,OAAO,CAAC;IAChC;IACA,IACEK,KAAK,CAACK,QAAQ,KAAKvB,SAAS,CAACG,KAAK,IAClCe,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACE,MAAM,IAChCO,QAAQ,CAACgB,MAAM,EACf;MACAhB,QAAQ,CAACgB,MAAM,CAACP,KAAK,EAAEL,OAAO,CAAC;IACjC;IACA,IACEK,KAAK,CAACK,QAAQ,KAAKvB,SAAS,CAACK,MAAM,IACnCa,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACI,SAAS,IACnCK,QAAQ,CAACiB,QAAQ,EACjB;MACAjB,QAAQ,CAACiB,QAAQ,CAACR,KAAK,EAAEL,OAAO,CAAC;IACnC;IACA,IACE,CAACK,KAAK,CAACK,QAAQ,KAAKvB,SAAS,CAACG,KAAK,IACjCe,KAAK,CAACK,QAAQ,KAAKvB,SAAS,CAACK,MAAM,KACrCa,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACG,KAAK,IAC/Be,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACK,MAAM,IAChCI,QAAQ,CAACkB,QAAQ,EACjB;MACAlB,QAAQ,CAACkB,QAAQ,CACfT,KAAK,EACLL,OAAO,EACPK,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACI,SAAS,IAAIc,KAAK,CAACE,KAAK,KAAKpB,SAAS,CAACE,MAAM,CACxE;IACH;EACF,CAAC;EAED,IAAIa,MAAM,EAAE;IACV,OAAOC,OAAO;EAChB;EAEA,OAAO,IAAAY,eAAQ,EACbZ,OAAO,EACP,CAAC,6BAA6B,EAAE,uBAAuB,CAAC,EACxDF,oBAAoB,CACrB;AACH"}